---
title: "Django入门之表单"
date: 2021-11-24T16:48:53+08:00
draft: true
---
# Django中的表单

# 课程介绍


# 慕旅游网中的表单

##  用户登录/注册

##  景点搜索

##  提交订单

##  后台管理（用户\景点等）

# 课程介绍

##  表单的基本使用

##  自定义表单

##  文件上传


##  内置的表单字段

##  表单相关介绍

##  自定义界面显示

# 表单的基本使用

##  创建第一个表单

##  多个字段的综合验证

##  从ORM模型创建表单

# 自定义表单

##  单个字段的表单验证

##  修改模型表单


##  通过表单实现文件上传

# 文件上传

##  结合ORM实现文件上传

# 表单的基本使用


# 表单相关介绍

# 本节内容

 了解 Django中的表单

 了解 与Flask中表单的区别

##  掌握 表单逻辑实现的基本流程

##  掌握 表单字段的基本使用


# 常见的表单元素

 表单标签——<form>

##  单行文本框/多行文本框

##  选择（单选、多选、下拉选择）

##  隐藏表单域

##  表单按钮

##  文件上传框

# Django中的表单

##  框架自带


# Flask中的表单使用

# 表单使用的步骤

##  第一步：创建表单类

##  第二步：添加到视图

##  第三步：渲染到模板

##  第四步：在视图中处理表单数据


# 第一步：创建表单类

##  示例代码

# 第二步：添加到视图

##  示例代码


##  示例代码

# 第三步：渲染到模板

# 在模板渲染表单

```
 as_p()
```
```
 as_ul()
```
 as_table()


##  示例代码

# 第四步：在视图中处理表单数据

# 表单字段（Field）

 表单字段继承自django.forms.Field

##  每个字段都可以有自定义的验证逻辑

##  每个字段都有钩子函数，方便扩充功能

##  每个字段都具有核心参数


# 字段的常用参数

```
 required——是否为必填，默认为必填
```
```
 label——label标签（如：输入框前的文字描述）
```
```
 initial——初始化数据
```
```
 help_text——帮助文字
```
# 字段的常用参数

 error_messages——覆盖字段引发异常后的错误显示

 disabled——禁用表单，界面上不可操作

 has_changed()——值是否发生了改变

 widget——定制界面显示方式（如：文本框、选择框）


## 记住表单使用的 4 个步骤

# 小结

Django为我们提供了哪些内置的表单字段呢

# 思考


# 内置的表单字段

# 本节内容

 了解 Django中的常见的表单类型

##  掌握 部分表单类型的使用


##  文本/字符串

# Django内置的字段

##  数值（整数，小数）

##  选择（单选/多选）

##  日期/时间

##  文件/文件上传

##  布尔

##  正则表达式

 CharField——字符串输入

 EmailField——邮件地址输入

 URLField——URL地址输入

```
 UUIDField——uuid字符串输入
```
# 文本/字符串


 FloatField——浮点数输入

 IntegerField——整数输入

 DecimalField——小数输入（更精确）

# 数值（整数，小数）

 ChoiceField——单选

 MultipleChoiceField——多选

 TypedChoiceField——高级选择（支持结果转换类型）

# 选择（单选/多选）


```
 DateField——日期选择
```
```
 DateTimeField——日期时间选择
```
```
 DurationField——时间片段timedelta
```
```
 TimeField——时间选择
```
# 日期/时间

# 文件/文件上传

```
 FileField——文件
```
 FilePathField——文件路径

```
 ImageField——图片
```

# 布尔

 BooleanField——True\False

 NullBooleanField——None\True\False

# 正则表达式

```
 RegexField——正则输入
```

## 孰能生巧，多加练习

# 小结

## 登录表单需要用到哪几种字段类型？

# 思考


# 创建第一个表单

# 本节内容

##  了解 表单类的可选参数、属性和方法

##  掌握 表单的设计和代码编写

##  掌握 初始化表单、表单验证等方法的使用


# 设计登录表单

##  用户名

##  密码

##  验证码

# 表单类的可选参数

```
 data——表单数据
```
 initial——初始化数据

```
 files——文件对象
```

```
 errors——表单验证后的错误信息
```
```
 fields——表单中的字段
```
```
 initial——初始化数据
```
# Form对象的属性

```
 is_bound——是否已经绑定数据
```
```
 cleaned_data——访问表单验证后的数据
```
# Form对象的方法

 as_p()/as_ul()/as_table()——渲染表单

 is_valid()——表单是否已经通过验证

 clean()——调用表单的验证/自定义的验证


# 在视图中获取表单值

##  GET请求

```
request.GET.get('name', None)
```
 POST请求

```
request.POST.get('name', None)
```
 文件对象

```
request.FILES.get('name', None)
```
## 尝试自己写一个登陆表单吧

# 小结


## 密码框输入的内容怎样显示"***"?

# 思考

# 自定义界面显示


# 本节内容

##  掌握 如何自定义密码框、多行文本的界面显示

##  了解 自定义界面显示的使用场景

# 使用场景

##  密码输入

 URL输入、Email输入

 多行文本输入


##  示例代码

```
class CommentForm(forms.Form):
""" 评论表单 """
content = forms.CharField(
label='内容',
widget=forms.Textarea
)
```
# 自定义界面显示

# 内置的widgets

##  文本输入

##  选择输入

##  文件上传

```
 复合Widget
```

# 文本输入

```
 TextInput
```
```
 NumberInput
```
```
 EmailInput
```
```
 URLInput
```
```
 PasswordInput
```
```
 HiddenInput
```
```
 DateInput
```
```
 DateTimeInput
```
```
 TimeInput
```
```
 Textarea
```
```
 Select
```
 NullBooleanSelect

```
 SelectMultiple
```
```
 CheckboxSelectMultiple
```
```
 RadioSelect
```
# 选择输入


 FileInput

# 文件上传

 MultipleHiddenInput

 SplitDateTimeWidget、 SplitHiddenDateTimeWidget

 SelectDateWidget

# 复合Widget


```
记住表单类型的widget参数
```
# 小结

## 登录表单中，要求用户名是手机号如何实现？

# 思考


# 自定义表单

# 单个字段的表单验证


# 本节内容

##  掌握 单个字段验证的实现方法

##  了解 表单验证的重要性

##  掌握 在模板中展示错误信息

# 表单验证

##  表单验证为了什么？

##  更好的用户体验

##  更少安全隐患

##  永远不要相信用户的输入


# 表单验证的步骤

```
 第一步：定义clean_xx验证方法
```
```
 第二步：获取对应的字段值并验证
```
```
 第三步：验证失败触发forms.ValidationError异常
```
```
 第四步：返回验证后的数据
```
```
 第五步：在html页面显示错误
```
# 验证用户名为手机号码

##  示例代码


```
记住clean_xxx方法
```
# 小结

## 登录表单中，如何验证用户名和密码是否正确？

# 思考


# 多个字段综合验证

# 本节内容

##  掌握 多个字段验证的实现方法

##  掌握 在模板中展示错误信息


# 实现步骤

```
 第一步：重写clean()方法
```
```
 第二步：获取用户名和密码数据并验证
```
```
 第三步：验证失败触发forms.ValidationError异常
```
```
 第四步：返回验证后的表单数据cleaned_data
```
 第五步：在html页面显示错误non_field_errors

# 多个字段综合验证

##  练习：验证用户名和密码是否正确


重写clean方法时要注意表单的数据获取

# 小结

## 是否可以从ORM模型定义表单?

# 思考


# 从ORM模型创建表单

# 本节内容

##  掌握 如何从ORM模型创建表单

##  了解 从ORM模型创建表单的使用场景

##  掌握 模型表单的配置


# 再看ORM模型

 是否可以根据Django模型直接生成表单

```
字段 表单字段 字段 表单字段
？
？
？
？
```
# ORM模型 vs 表单模型

##  字段类型的对应关系

```
字段 表单字段
```
##  查看更多>


# 从ORM模型创建表单

##  示例：从模型创建用户

# Meta类的配置选项

 model——对应的ORM模型

 fields——ORM模型中哪些字段需要出现在表单中

 exclude——ORM模型中哪些字段不需要出现在表单中

```
 help_texts——重写使用帮助信息
```
```
 labels——设置表单输入前的文字提示
```

# Meta类的配置选项

 widgets——自定义界面显示

```
 error_messages——配置表单验证中的错误提示
```
```
重点掌握Meta类的model和fields配置
```
# 小结


## 新增用户时保存用户详细信息如何实现？

# 思考

# 修改模型表单


# 本节内容

##  掌握 如何修改界面上的显示

##  了解 修改模型表单的使用场景

##  掌握 如何重写模型表单的验证和保存方法

# 修改模型表单

##  场景一：如何将密码输入设置为***？

```
 场景二：如何给模型表单添加新的css类？
```
##  使用场景


# 修改模型表单

##  改变界面上的文字显示

# Meta类的配置选项

 widgets——自定义界面显示

```
 error_messages——配置表单验证中的错误提示
```

# 修改模型表单

##  添加表单验证

##  保存用户详细信息

## 模型表单也是表单，所以表单验证的实现思路是

## 一样的

# 小结


```
在Django中如何实现文件上传？
```
# 思考

# 通过表单实现文件上传


# 本节内容

 掌握 通过request.files获取文件信息

##  了解 文件上传的逻辑

 掌握 通过Django表单上传文件

# 文件上传

 表单设置enctype="multipart/form-data"

 在视图中通过request.FILES来获取文件对象


# 文件上传

##  将文件保存到磁盘

# 使用Django表单

##  表单中的相关字段

```
forms.ImageField
```
```
 表单类的参数
```
```
form = AvatarUploadForm(request.POST, request.FILES)
```

通过settings中的配置设置上传路径能提升代码
的可维护性

# 小结

## 还有没有更简单的方式实现文件上传呢？

# 思考


# 结合ORM实现文件上传

# 本节内容

##  掌握 使用ORM上传文件

##  了解 ORM中文件上传的字段类型

##  掌握 文件路径的设置技巧


# 结合ORM模型上传

##  ORM中相关的类型

```
ImageField
```
```
FileField
```
```
 类型参数upload_to
```
```
models.FileField(upload_to='uploads/%Y/%m/%d/')
```
## 按月份存放上传的文件也是一个不错的优化技巧

# 小结


# 课程总结

# 知识点回顾


# 经验总结


